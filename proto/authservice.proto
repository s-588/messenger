syntax = "proto3";

package authservice;

option go_package = "authservice/";

service AuthService {
  rpc Register(RegisterRequest) returns ( RegisterResponse);
  rpc Authorize(AuthorizeRequest) returns (AuthorizeResponse);
  rpc Authenticate(AuthenticateRequest) returns (AuthenticateResponse);

  rpc ChangeUsername(ChangeUsernameRequest) returns (ChangeUsernameResponse);
  rpc ChangePassword(ChangePasswordRequest) returns (ChangePasswordResponse);
  rpc DeleteUser(DeleteUserRequest) returns (DeleteUserResponse);
}

message DeleteUserRequest{
  string user_id = 1;
}

message DeleteUserResponse{ 
    bool success = 1;
}

message ChangeUsernameRequest{
  string user_id = 1;
  string username = 2;
}

message ChangeUsernameResponse{ 
    bool success = 1;
}

message ChangePasswordRequest{
  string user_id = 1;
  string password = 2;
}

message ChangePasswordResponse{ 
  bool success = 1;
}

message RegisterRequest{
  string username = 1;
  string password = 2;
}

message AuthorizeRequest{
  string token = 1; // jwt token 
  int32 permission = 2; // bitwise permissions to check
}
message AuthorizeResponse{ 
  bool authorized = 1;
}

message AuthenticateRequest{
  string username = 1;
  string password = 2;
}

message RegisterResponse{
  string jwt_token = 1; 
  string refresh_token = 2;
}

message AuthenticateResponse{
  string jwt_token = 1; 
  string refresh_token = 2;
}
